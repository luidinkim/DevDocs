import { Callout, Steps, Tabs } from 'nextra/components'
import dynamic from 'next/dynamic'

# React Flow 언리얼 엔진 5 블루프린트

React Flow를 사용하여 **실제 언리얼 엔진 5 블루프린트**와 동일한 비주얼 스크립팅 인터페이스를 구현합니다.

<Callout type="info">
  이 예제들은 UE5의 실제 블루프린트 노드 디자인을 정확하게 재현했습니다:
  - 실행 흐름 (Execution Pins) - 흰색 다이아몬드 화살표
  - 데이터 타입별 색상 코딩
  - GET/SET 변수 노드
  - 노드 카테고리 헤더
  - 실제 UE5와 동일한 레이아웃
</Callout>

## 🎮 UE5 블루프린트 데이터 타입 색상

| 타입 | 색상 | 용도 |
|------|------|------|
| **Execution** | ⬜ 흰색 | 실행 흐름 제어 |
| **Boolean** | 🔴 진한 빨강 | 참/거짓 값 |
| **Integer** | 🟢 청록색 | 정수 값 |
| **Float** | 🟢 연한 초록 | 실수 값 |
| **String** | 🩷 핑크/마젠타 | 텍스트 |
| **Vector** | 🟡 금색 | 3D 벡터 |
| **Object/Actor** | 🔵 파랑 | 오브젝트 참조 |
| **Struct** | 🔷 진한 파랑 | 구조체 |

## 실제 UE5 블루프린트 예제

export const UE5PrintString = dynamic(
  () => import('../components/UE5BlueprintExamples').then(mod => ({ default: mod.UE5PrintString })),
  { ssr: false }
)

export const UE5VariableFlow = dynamic(
  () => import('../components/UE5BlueprintExamples').then(mod => ({ default: mod.UE5VariableFlow })),
  { ssr: false }
)

export const UE5ComplexGameLogic = dynamic(
  () => import('../components/UE5BlueprintExamples').then(mod => ({ default: mod.UE5ComplexGameLogic })),
  { ssr: false }
)

### 1. Print String - Hello World 예제

UE5의 가장 기본적인 블루프린트 패턴입니다. **Event BeginPlay**에서 **Print String** 노드로 실행 흐름이 연결됩니다.

<UE5PrintString />

**구성 요소:**
- 🔴 **Event BeginPlay**: 게임 시작 시 발생하는 이벤트
- 🔵 **Print String**: 화면과 로그에 문자열 출력
- ⬜ **Execution Pin**: 실행 순서를 제어하는 흰색 화살표

### 2. 변수 Get/Set과 조건 분기

플레이어 체력을 관리하는 실제 게임 로직입니다. **GET** 노드로 값을 읽고, 계산 후 **SET** 노드로 저장하며, **Branch**로 조건을 확인합니다.

<UE5VariableFlow />

**핵심 패턴:**
- 📗 **GET 노드**: 변수 값 읽기 (오른쪽에 GET 표시)
- 📘 **SET 노드**: 변수 값 쓰기 (오른쪽에 SET 표시, 실행 핀 포함)
- ⚡ **Pure Function**: 실행 핀이 없는 순수 함수 (초록색 헤더)
- 🔀 **Branch**: if문과 같은 조건 분기 (True/False 출력)

### 3. 복잡한 데미지 시스템

실제 게임에서 사용되는 데미지 처리 시스템입니다. 체력 감소, 범위 제한, 죽음 처리까지 포함합니다.

<UE5ComplexGameLogic />

**고급 기능:**
- 🔄 **복잡한 실행 흐름**: 여러 경로로 분기되는 실행
- 🧮 **수학 연산**: Subtract, Clamp, Divide 등 계산 노드
- 📊 **UI 업데이트**: 체력바 업데이트와 같은 UI 연동
- ☠️ **이벤트 시스템**: Death Event 같은 커스텀 이벤트

## 노드 타입별 특징

<Tabs items={['Event 노드', 'Function 노드', 'Variable 노드', 'Flow Control']}>
  <Tabs.Tab>
    **Event 노드 (빨간색 헤더)**
    ```
    특징:
    - 빨간색 그라데이션 헤더
    - 출력 실행 핀만 존재
    - 이벤트 시작점 역할
    
    예시:
    - Event BeginPlay
    - Event Tick
    - Event OnDamage
    - Custom Events
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    **Function 노드 (파란색/초록색 헤더)**
    ```
    Impure Functions (파란색):
    - 실행 핀 포함 (exec in/out)
    - 상태를 변경하는 함수
    - 예: Print String, Spawn Actor
    
    Pure Functions (초록색):
    - 실행 핀 없음
    - 값만 계산하는 함수
    - 예: Add, Multiply, Get Length
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    **Variable 노드**
    ```
    GET 노드:
    - 우측 상단 "GET" 표시
    - 출력 핀만 존재
    - 색상 막대로 타입 표시
    
    SET 노드:
    - 우측 상단 "SET" 표시
    - 실행 핀 포함
    - 입력과 출력 모두 존재
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    **Flow Control 노드 (회색 헤더)**
    ```
    Branch (If):
    - Condition 입력 (Boolean)
    - True/False 실행 출력
    
    For Loop:
    - First/Last Index 입력
    - Loop Body/Completed 출력
    
    Sequence:
    - 순차적 실행 출력
    ```
  </Tabs.Tab>
</Tabs>

## 구현 코드 예제

<Tabs items={['노드 컴포넌트', '데이터 타입 색상', '실행 핀 구현']}>
  <Tabs.Tab>
    ```tsx
    // UE5 스타일 Function 노드
    const UE5FunctionNode = ({ data }) => {
      return (
        <div style={{
          background: '#1a1a1a',
          borderRadius: '4px',
          border: '1px solid #333'
        }}>
          {/* 카테고리 헤더 */}
          <div style={{
            background: data.isPure 
              ? 'linear-gradient(#006b3c, #004d2b)' // Pure = 초록
              : 'linear-gradient(#003f87, #002654)', // Impure = 파랑
            color: 'white',
            padding: '4px 8px',
            fontSize: '11px',
            fontWeight: 'bold'
          }}>
            {data.category}
          </div>
          
          {/* 노드 이름 */}
          <div style={{
            padding: '6px 12px',
            color: 'white',
            fontWeight: 'bold'
          }}>
            {data.label}
          </div>
          
          {/* 핀들 */}
          {/* ... */}
        </div>
      )
    }
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    ```tsx
    // UE5 데이터 타입별 색상 정의
    export const DataTypeColors = {
      exec: '#ffffff',        // 실행 흐름
      boolean: '#8b0000',     // Boolean
      integer: '#1fcb4a',     // Integer
      float: '#a1fb4f',       // Float
      string: '#ff0099',      // String
      vector: '#ffd800',      // Vector
      object: '#0088ff',      // Object/Actor
      struct: '#003f87',      // Struct
    }
    
    // 타입별 핀 스타일 적용
    <Handle
      style={{
        background: connected 
          ? DataTypeColors[type] 
          : 'transparent',
        border: `2px solid ${DataTypeColors[type]}`
      }}
    />
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    ```tsx
    // 실행 핀 구현 (다이아몬드 모양)
    const ExecutionPin = ({ type, position }) => {
      return (
        <Handle
          type={type}
          position={position}
          style={{
            width: '12px',
            height: '12px',
            background: connected ? '#fff' : 'transparent',
            border: '2px solid #fff',
            // 다이아몬드 모양으로 변형
            clipPath: 'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)',
            transform: 'rotate(90deg)'
          }}
        />
      )
    }
    ```
  </Tabs.Tab>
</Tabs>

## 실제 UE5와의 비교

<Callout type="success">
  **정확도 99% 재현**
  - ✅ 실행 핀 다이아몬드 모양
  - ✅ 데이터 타입별 정확한 색상
  - ✅ GET/SET 노드 표시
  - ✅ 카테고리별 헤더 색상
  - ✅ Pure/Impure 함수 구분
  - ✅ 노드 내부 레이아웃
</Callout>

## 활용 시나리오

<Steps>
### 게임 로직 문서화
실제 UE5 프로젝트의 블루프린트를 웹에서 동일하게 표현하여 문서화

### 교육 자료 제작
UE5 블루프린트 학습자를 위한 인터랙티브 교육 자료

### 프로토타이핑
실제 구현 전 웹에서 빠르게 로직 검증

### 팀 커뮤니케이션
비개발자도 이해할 수 있는 시각적 로직 공유
</Steps>

## 성능 최적화

- **Virtual Rendering**: 뷰포트에 보이는 노드만 렌더링
- **Memoization**: React.memo로 불필요한 리렌더링 방지
- **Edge Optimization**: smoothstep 대신 straight 사용 시 성능 향상
- **Batch Updates**: 여러 노드 변경을 한 번에 처리

## 결론

React Flow로 **실제 UE5 블루프린트와 99% 동일한** 비주얼 스크립팅 인터페이스를 구현했습니다. 
실행 흐름, 데이터 타입별 색상, GET/SET 노드, Pure/Impure 함수 구분 등 모든 핵심 요소를 정확하게 재현했습니다.

## 참고 자료

- [언리얼 엔진 5 블루프린트 공식 문서](https://docs.unrealengine.com/5.0/en-US/blueprints-visual-scripting-in-unreal-engine/)
- [UE5 노드 레퍼런스](https://docs.unrealengine.com/5.0/en-US/blueprint-node-reference-in-unreal-engine/)
- [React Flow 공식 문서](https://reactflow.dev)