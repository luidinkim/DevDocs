import { Callout, Steps, Tabs, Code } from 'nextra/components'
import dynamic from 'next/dynamic'

export const JumpPadIntermediateBlueprint = dynamic(
  () => import('../../../components/UE5BlueprintExamples').then(mod => ({ default: mod.JumpPadIntermediateBlueprint })),
  { ssr: false }
)

export const HandleReactivationBlueprint = dynamic(
  () => import('../../../components/UE5BlueprintExamples').then(mod => ({ default: mod.HandleReactivationBlueprint })),
  { ssr: false }
)


# 중급 점프패드 - 변수와 방향 제어

<Callout type="info" emoji="⚡">
  이 가이드에서는 변수를 활용하여 쉽게 커스터마이징 가능한 점프패드를 만듭니다.
  Arrow Component를 사용하여 발사 방향을 시각적으로 제어하는 방법을 배웁니다.
</Callout>

## 학습 목표

- 변수를 사용한 파라미터화
- Arrow Component로 방향 제어
- 시각/사운드 효과 추가
- 재사용 대기시간 구현
- 에디터에서 쉽게 조정 가능한 점프패드

## 블루프린트 준비

<Steps>
### 새 블루프린트 생성

1. `BP_JumpPad_Basic`을 복제 (Ctrl+W)
2. 이름을 `BP_JumpPad_Intermediate`로 변경
3. 더블클릭하여 블루프린트 에디터 열기

### 폴더 정리

```plaintext
Content/
└── Blueprints/
    └── JumpPads/
        ├── BP_JumpPad_Basic
        └── BP_JumpPad_Intermediate
```
</Steps>

## 컴포넌트 업그레이드

### 새로운 컴포넌트 구조

```plaintext
BP_JumpPad_Intermediate (Actor)
├── DefaultSceneRoot
├── StaticMesh (패드 메시)
├── BoxCollision (트리거 영역)
├── ArrowComponent (발사 방향 표시) ✨ NEW
├── ParticleSystem (시각 효과) ✨ NEW
└── AudioComponent (사운드 효과) ✨ NEW
```

### Arrow Component 추가

<Tabs items={['컴포넌트 추가', '설정값']}>  
  <Tabs.Tab>
    **Arrow Component 추가 방법**
    
    1. Components 패널에서 **Add Component**
    2. **Arrow** 검색 및 선택
    3. 이름을 `LaunchDirection`으로 변경
    4. StaticMesh의 자식으로 드래그
  </Tabs.Tab>
  
  <Tabs.Tab>
    **Arrow Component 설정**
    
    - **Relative Location**: `(0, 0, 10)`
    - **Relative Rotation**: `(-45, 0, 0)` (45도 위쪽)
    - **Arrow Size**: `2.0`
    - **Arrow Color**: `(0, 255, 0)` (녹색)
    - **Hidden in Game**: `False` (디버그용)
    
    <Callout type="tip">
      Hidden in Game을 나중에 True로 변경하면 게임에서 화살표가 보이지 않습니다.
    </Callout>
  </Tabs.Tab>
</Tabs>

### 효과 컴포넌트 추가

<Steps>
### Particle System 추가

1. **Add Component** → **Particle System**
2. 이름: `LaunchEffect`
3. Template: `P_Smoke` (또는 원하는 파티클)
4. Auto Activate: `False`

### Audio Component 추가

1. **Add Component** → **Audio**  
2. 이름: `LaunchSound`
3. Sound: 원하는 사운드 에셋
4. Auto Activate: `False`
</Steps>

## 변수 추가하기

### 변수 목록

| 변수명 | 타입 | 기본값 | 설명 |
|--------|------|--------|------|
| `JumpForce` | Float | 2000.0 | 점프 강도 |
| `bOverrideVelocity` | Boolean | True | 기존 속도 무시 |
| `bCanReactivate` | Boolean | True | 재사용 가능 여부 |
| `ReactivateDelay` | Float | 0.5 | 재사용 대기시간 |
| `bIsActive` | Boolean | True | 현재 활성 상태 |

### 변수 생성 방법

<Steps>
### 변수 추가

1. My Blueprint 패널에서 **Variables** 섹션
2. **+** 버튼 클릭
3. 변수명 입력 (예: `JumpForce`)
4. 변수 타입 선택

### 변수 설정

1. 변수 선택
2. Details 패널에서:
   - **Default Value**: 기본값 설정
   - **Instance Editable**: ✅ (에디터에서 조정 가능)
   - **Category**: "Jump Pad Settings"
   - **Tooltip**: 설명 추가

### 카테고리별 정리

변수들을 카테고리로 정리하면 에디터에서 찾기 쉽습니다:
- **Jump Settings**: JumpForce, bOverrideVelocity
- **Reactivation**: bCanReactivate, ReactivateDelay
- **Runtime**: bIsActive (Instance Editable 해제)
</Steps>

## 개선된 이벤트 그래프

### 방향 기반 발사 로직

<JumpPadIntermediateBlueprint />

### Custom Events 구현

<Callout type="info" emoji="🎯">
  Custom Event는 블루프린트 내에서 재사용 가능한 함수를 만드는 방법입니다.
  코드를 모듈화하고 중복을 줄일 수 있습니다.
</Callout>

<Tabs items={['Play Effects', 'Handle Reactivation', 'ReEnable Jump Pad']}>
  <Tabs.Tab>
    **Play Effects 이벤트**
    
    효과를 재생하는 커스텀 이벤트:
    
    1. **Activate** (Particle System Component)
       - Target: `LaunchEffect`
    
    2. **Play** (Audio Component)
       - Target: `LaunchSound`
    
    3. **Spawn Emitter at Location** (옵션)
       - Emitter Template: 추가 파티클
       - Location: Actor Location
  </Tabs.Tab>
  
  <Tabs.Tab>
    **Handle Reactivation 이벤트**
    
    재사용 대기시간 처리:
    
    <HandleReactivationBlueprint />
  </Tabs.Tab>
  
  <Tabs.Tab>
    **ReEnable Jump Pad 이벤트**
    
    점프패드 재활성화:
    
    - SET Is Active (True)
    - Reset Material
    - Play Ready Sound
    - Spawn Reactivation Particle
  </Tabs.Tab>
</Tabs>

## 고급 기능 추가

### 발사 각도 미세 조정

<Callout type="tip" emoji="📐">
  Arrow Component의 Rotation을 조정하여 발사 각도를 변경할 수 있습니다.
  X축 회전: 위/아래 각도, Z축 회전: 좌/우 방향
</Callout>

### 변수 기반 Override 설정

```plaintext
Launch Character 노드에 연결:
- XY Override: GET bOverrideXY 변수
- Z Override: GET bOverrideZ 변수
```

### 디버그 시각화

<Tabs items={['Construction Script', '실행 결과']}>  
  <Tabs.Tab>
    **Construction Script에서 궤적 표시**
    
    ```plaintext
    Construction Script
    ├── Get Arrow Forward Vector
    ├── Multiply (Vector * JumpForce)
    ├── Draw Debug Arrow
    │   ├── Start: Actor Location
    │   ├── End: Start + (Direction * 200)
    │   ├── Arrow Size: 50
    │   ├── Color: Green
    │   └── Duration: 0 (영구)
    └── Draw Debug Line (궤적)
    ```
  </Tabs.Tab>
  
  <Tabs.Tab>
    에디터에서 점프패드를 선택하면:
    - 녹색 화살표로 발사 방향 표시
    - 예상 궤적 라인 표시
    - 실시간으로 각도 조정 가능
  </Tabs.Tab>
</Tabs>

## 에디터에서 사용하기

### 인스턴스별 설정

레벨에 배치된 각 점프패드를 개별 설정할 수 있습니다:

1. 레벨에서 점프패드 선택
2. Details 패널에서 **Jump Pad Settings** 카테고리 찾기
3. 값 조정:
   - **Jump Force**: 500 ~ 5000
   - **Reactivate Delay**: 0 ~ 5초
   - Arrow Component 회전 조정

### 프리셋 만들기

<Steps>
### 다양한 변형 생성

1. `BP_JumpPad_Intermediate` 복제
2. 기본값 변경:
   - 약한 점프패드: JumpForce = 1000
   - 강한 점프패드: JumpForce = 3000
   - 대각선 점프패드: Arrow Rotation = (-45, 45, 0)

### Child Blueprint 생성

1. `BP_JumpPad_Intermediate` 우클릭
2. **Create Child Blueprint Class**
3. 자식 클래스에서 기본값만 변경
</Steps>

## 성능 최적화

### 최적화 팁

<Callout type="warning" emoji="⚡">
  많은 점프패드를 사용할 때는 다음 사항을 고려하세요:
</Callout>

- **파티클 LOD**: 거리별 디테일 조정
- **사운드 감쇠**: Max Distance 설정
- **Hidden in Game**: Arrow Component 숨기기
- **Collision 최적화**: 필요한 채널만 체크

## 문제 해결

### 재사용이 안 될 때

1. `bCanReactivate`가 True인지 확인
2. Timer 노드가 올바르게 연결되었는지 확인
3. `bIsActive` 변수가 제대로 토글되는지 확인

### 방향이 이상할 때

1. Arrow Component가 올바른 부모에 연결되었는지 확인
2. Get Forward Vector가 Arrow Component를 타겟으로 하는지 확인
3. Local vs World 좌표계 확인

## 다음 단계

<Callout type="success" emoji="🎯">
  변수와 방향 제어가 가능한 점프패드를 완성했습니다!
  이제 더 고급 기능을 추가해봅시다.
</Callout>

다음 가이드에서 배울 내용:
- 🎯 궤적 미리보기 시스템
- 🌟 다양한 발사 모드
- 📊 네트워크 리플리케이션
- 🎮 게임패드 진동 효과

[고급 점프패드로 계속하기 →](/unreal-engine-5/jump-map/jump-pad-advanced)