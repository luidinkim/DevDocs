---
title: "Player Controller & Player State êµ¬í˜„"
description: "í”Œë ˆì´ì–´ ì œì–´ì™€ ìƒíƒœ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„"
---

import { Callout, Steps, Tabs, Card } from 'nextra/components'
import { User, Gamepad2, Trophy, BarChart3 } from 'lucide-react'
import { LinkCard } from '@/components/link-card'
import BlueprintExample_New from '@/components/blueprint-example-new'

# ğŸ‘¤ Player Controller & Player State êµ¬í˜„

<Callout type="info" emoji="ğŸ®">
Player ControllerëŠ” ì…ë ¥ì„ ê´€ë¦¬í•˜ê³ , Player StateëŠ” í”Œë ˆì´ì–´ì˜ ê²Œì„ ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
</Callout>

## 1. Player Controller (PC_JumpMap)

### í´ë˜ìŠ¤ ìƒì„±

<Steps>
### Blueprint í´ë˜ìŠ¤ ìƒì„±
1. Content Browserì—ì„œ ìš°í´ë¦­
2. **Blueprint Class** ì„ íƒ
3. **PlayerController** ìƒì†
4. ì´ë¦„: `PC_JumpMap`

### ì´ˆê¸° ì„¤ì •
Class Defaultsì—ì„œ:
- **Input Mode**: Game Only
- **Show Mouse Cursor**: False (ê²Œì„ ì¤‘)
- **Enable Click Events**: False
</Steps>

### ë³€ìˆ˜ ì„¤ì •

<Tabs items={['Core Variables', 'UI References', 'Input Settings']}>
  <Tabs.Tab>
```cpp
// === Core Variables ===
GameModeRef: GM_JumpMap              // Game Mode ì°¸ì¡°
PlayerStateRef: PS_JumpMap           // Player State ì°¸ì¡°
ControlledPawn: Character            // ì œì–´ ì¤‘ì¸ í°
bIsGamePaused: Boolean = False      // ì¼ì‹œì •ì§€ ìƒíƒœ
bCanControl: Boolean = True         // ì…ë ¥ ê°€ëŠ¥ ì—¬ë¶€
```
  </Tabs.Tab>
  
  <Tabs.Tab>
```cpp
// === UI References ===
HUDWidget: WBP_HUD                  // ë©”ì¸ HUD
PauseMenuWidget: WBP_PauseMenu      // ì¼ì‹œì •ì§€ ë©”ë‰´
ResultsWidget: WBP_Results          // ê²°ê³¼ í™”ë©´
CurrentWidget: UserWidget            // í˜„ì¬ í™œì„± ìœ„ì ¯
```
  </Tabs.Tab>
  
  <Tabs.Tab>
```cpp
// === Input Settings ===
MouseSensitivity: Float = 1.0       // ë§ˆìš°ìŠ¤ ê°ë„
InvertYAxis: Boolean = False        // Yì¶• ë°˜ì „
JumpInputBuffer: Float = 0.2        // ì í”„ ì…ë ¥ ë²„í¼ ì‹œê°„
InputMode: Enum = GameOnly          // ì…ë ¥ ëª¨ë“œ
```
  </Tabs.Tab>
</Tabs>

### Event Graph êµ¬í˜„

#### BeginPlay ì´ë²¤íŠ¸

```mermaid
graph LR
    A[Event BeginPlay] --> B[Super BeginPlay]
    B --> C[Get Game Mode]
    C --> D[Cast to GM_JumpMap]
    D --> E[Store Reference]
    E --> F[Get Player State]
    F --> G[Cast to PS_JumpMap]
    G --> H[Initialize HUD]
    H --> I[Set Input Mode]
```

<BlueprintExample_New
  title="BeginPlay Event"
  description="Player Controller ì´ˆê¸°í™” ë¡œì§"
  code={`Event BeginPlay
â”‚
â”œâ”€ Super BeginPlay
â”‚
â”œâ”€ Get Game Mode â†’ Cast to GM_JumpMap
â”‚   â””â”€ SET GameModeRef
â”‚
â”œâ”€ Get Player State â†’ Cast to PS_JumpMap
â”‚   â””â”€ SET PlayerStateRef
â”‚
â”œâ”€ Create HUD Widget
â”‚   â”œâ”€ Class: WBP_HUD
â”‚   â””â”€ Add to Viewport (Z-Order: 0)
â”‚
â””â”€ Set Input Mode Game Only
    â””â”€ Flush Input`}
  nodes={[
    { type: "event", label: "BeginPlay", color: "red" },
    { type: "function", label: "Super BeginPlay" },
    { type: "getter", label: "Get Game Mode" },
    { type: "cast", label: "Cast to GM_JumpMap" },
    { type: "getter", label: "Get Player State" },
    { type: "cast", label: "Cast to PS_JumpMap" },
    { type: "function", label: "Create Widget" },
    { type: "function", label: "Add to Viewport" },
    { type: "function", label: "Set Input Mode" }
  ]}
/>

#### Input Actions ì„¤ì •

<Callout type="default" emoji="ğŸ®">
**Enhanced Input System ì‚¬ìš©**:
1. Input Actions ìƒì„± (Content/Input/Actions/)
2. Input Mapping Context ì„¤ì •
3. Player Controllerì— ë°”ì¸ë”©
</Callout>

##### Jump Input Action

```cpp
// IA_Jump - Jump Input Action
Value Type: Boolean
Triggers: Pressed, Released

// Player Controllerì—ì„œ ì²˜ë¦¬
Event IA_Jump (Enhanced Input)
â”‚
â”œâ”€ Triggered
â”‚   â””â”€ Character->Jump()
â”‚
â””â”€ Completed
    â””â”€ Character->StopJumping()
```

##### Pause Input Action

```cpp
// IA_Pause - Pause Game
Event IA_Pause
â”‚
â”œâ”€ Branch: bIsGamePaused?
â”‚   â”œâ”€ True â†’ Resume Game
â”‚   â””â”€ False â†’ Pause Game
â”‚
â”œâ”€ Toggle Pause State
â”‚   â”œâ”€ Set Game Paused
â”‚   â”œâ”€ Show/Hide Pause Menu
â”‚   â””â”€ Set Input Mode (UI/Game)
â”‚
â””â”€ Update HUD Visibility
```

### ì»¤ìŠ¤í…€ í•¨ìˆ˜ë“¤

#### EnablePlayerInput

```cpp
Function EnablePlayerInput(bEnable: Boolean)
{
    bCanControl = bEnable
    
    if (bEnable)
    {
        // ì…ë ¥ í™œì„±í™”
        Set Input Mode Game Only
        Set Ignore Move Input = False
        Set Ignore Look Input = False
    }
    else
    {
        // ì…ë ¥ ë¹„í™œì„±í™”
        Set Ignore Move Input = True
        Set Ignore Look Input = True
    }
}
```

#### ShowResultScreen

```cpp
Function ShowResultScreen(Score: Integer, Time: Float, bSuccess: Boolean)
{
    // ê²°ê³¼ ìœ„ì ¯ ìƒì„±
    ResultsWidget = Create Widget(WBP_Results)
    
    // ë°ì´í„° ì„¤ì •
    ResultsWidget->SetScore(Score)
    ResultsWidget->SetTime(Time)
    ResultsWidget->SetSuccess(bSuccess)
    
    // í™”ë©´ì— ì¶”ê°€
    ResultsWidget->Add to Viewport (Z-Order: 10)
    
    // ì…ë ¥ ëª¨ë“œ ë³€ê²½
    Set Input Mode UI Only
    Set Show Mouse Cursor = True
    
    // í”Œë ˆì´ì–´ ì…ë ¥ ë¹„í™œì„±í™”
    EnablePlayerInput(False)
}
```

## 2. Player State (PS_JumpMap)

### ë³€ìˆ˜ ì„¤ì •

<Tabs items={['Score Variables', 'Player Stats', 'Replicated Data']}>
  <Tabs.Tab>
```cpp
// === Score Variables ===
CurrentScore: Integer = 0           // í˜„ì¬ ì ìˆ˜
CoinsCollected: Integer = 0         // ìˆ˜ì§‘í•œ ì½”ì¸ ìˆ˜
TimeBonus: Float = 0.0              // ì‹œê°„ ë³´ë„ˆìŠ¤
FinalScore: Integer = 0             // ìµœì¢… ì ìˆ˜
ScoreMultiplier: Float = 1.0        // ì ìˆ˜ ë°°ìœ¨
```
  </Tabs.Tab>
  
  <Tabs.Tab>
```cpp
// === Player Stats ===
Deaths: Integer = 0                 // ì‚¬ë§ íšŸìˆ˜
Jumps: Integer = 0                  // ì í”„ íšŸìˆ˜
CheckpointsReached: Integer = 0     // ë„ë‹¬í•œ ì²´í¬í¬ì¸íŠ¸
DistanceTraveled: Float = 0.0       // ì´ë™ ê±°ë¦¬
PlayTime: Float = 0.0                // ì´ í”Œë ˆì´ ì‹œê°„
```
  </Tabs.Tab>
  
  <Tabs.Tab>
```cpp
// === Replicated Variables ===
Rep_Score: Integer (Replicated)     // ë™ê¸°í™”ëœ ì ìˆ˜
Rep_CoinsCollected: Integer (Rep)   // ë™ê¸°í™”ëœ ì½”ì¸ ìˆ˜
Rep_PlayerName: String (Replicated) // í”Œë ˆì´ì–´ ì´ë¦„
Rep_PlayerRank: Integer (Replicated)// í˜„ì¬ ìˆœìœ„
```
  </Tabs.Tab>
</Tabs>

### í•µì‹¬ í•¨ìˆ˜ êµ¬í˜„

#### AddScore í•¨ìˆ˜

<div className="bg-gray-900 rounded-lg p-4 mt-4">
```blueprint
Function: AddScore
â”œâ”€ Input: Points (Integer)
â”œâ”€ Output: NewScore (Integer)
â”‚
â””â”€ Logic:
    1. Calculate: Points * ScoreMultiplier
    2. CurrentScore += Calculated Points
    3. Call OnRep_Score() (for UI update)
    4. Broadcast OnScoreChanged Event
    5. Return CurrentScore
```
</div>

#### CollectCoin í•¨ìˆ˜

```cpp
Function CollectCoin(CoinValue: Integer = 100)
{
    // ì½”ì¸ ì¹´ìš´íŠ¸ ì¦ê°€
    CoinsCollected++
    
    // ì ìˆ˜ ì¶”ê°€
    AddScore(CoinValue)
    
    // ì‚¬ìš´ë“œ ì¬ìƒ
    Play Sound 2D ("CoinCollect")
    
    // UI ì—…ë°ì´íŠ¸
    if (HUDWidget)
    {
        HUDWidget->UpdateCoinCounter(CoinsCollected)
    }
    
    // ì´ë²¤íŠ¸ ë°œìƒ
    OnCoinCollected.Broadcast(CoinsCollected)
    
    // ì—…ì  ì²´í¬
    CheckCoinAchievements()
}
```

#### ResetPlayerStats í•¨ìˆ˜

```cpp
Function ResetPlayerStats()
{
    // ì ìˆ˜ ì´ˆê¸°í™”
    CurrentScore = 0
    CoinsCollected = 0
    TimeBonus = 0.0
    FinalScore = 0
    ScoreMultiplier = 1.0
    
    // í†µê³„ ì´ˆê¸°í™”
    Deaths = 0
    Jumps = 0
    CheckpointsReached = 0
    DistanceTraveled = 0.0
    
    // UI ì—…ë°ì´íŠ¸
    UpdateAllUI()
    
    // ë„¤íŠ¸ì›Œí¬ ë™ê¸°í™”
    if (Has Authority)
    {
        OnRep_Score()
        OnRep_CoinsCollected()
    }
}
```

### ì´ë²¤íŠ¸ ì²˜ë¦¬

#### OnRep í•¨ìˆ˜ë“¤ (Replication)

```cpp
// ì ìˆ˜ê°€ ë™ê¸°í™”ë  ë•Œ
Function OnRep_Score()
{
    // UI ì—…ë°ì´íŠ¸
    if (HUDWidget)
    {
        HUDWidget->UpdateScore(Rep_Score)
        
        // ì ìˆ˜ ì• ë‹ˆë©”ì´ì…˜
        HUDWidget->PlayScoreAnimation()
    }
}

// ì½”ì¸ì´ ë™ê¸°í™”ë  ë•Œ
Function OnRep_CoinsCollected()
{
    // UI ì—…ë°ì´íŠ¸
    if (HUDWidget)
    {
        HUDWidget->UpdateCoinCounter(Rep_CoinsCollected)
    }
}
```

### í†µê³„ ì¶”ì  ì‹œìŠ¤í…œ

#### UpdatePlayerStats

```cpp
Function UpdatePlayerStats(DeltaTime: Float)
{
    // í”Œë ˆì´ ì‹œê°„ ì—…ë°ì´íŠ¸
    PlayTime += DeltaTime
    
    // ì´ë™ ê±°ë¦¬ ê³„ì‚°
    if (ControlledPawn)
    {
        CurrentLocation = ControlledPawn->GetActorLocation()
        Distance = (CurrentLocation - LastLocation).Size()
        DistanceTraveled += Distance
        LastLocation = CurrentLocation
    }
    
    // ì í”„ ì¹´ìš´íŠ¸ (Jump ì´ë²¤íŠ¸ì—ì„œ í˜¸ì¶œ)
    // ì‚¬ë§ ì¹´ìš´íŠ¸ (Death ì´ë²¤íŠ¸ì—ì„œ í˜¸ì¶œ)
}
```

## 3. Player Input Mapping

### Enhanced Input ì„¤ì •

<Steps>
### Input Actions ìƒì„±
```
Content/Input/Actions/
â”œâ”€â”€ IA_Move (Vector2D)
â”œâ”€â”€ IA_Look (Vector2D)
â”œâ”€â”€ IA_Jump (Boolean)
â”œâ”€â”€ IA_Sprint (Boolean)
â””â”€â”€ IA_Pause (Boolean)
```

### Input Mapping Context ìƒì„±
```
Content/Input/
â””â”€â”€ IMC_JumpMap
    â”œâ”€â”€ Move â†’ WASD/Left Stick
    â”œâ”€â”€ Look â†’ Mouse/Right Stick
    â”œâ”€â”€ Jump â†’ Space/South Button
    â”œâ”€â”€ Sprint â†’ Shift/Left Trigger
    â””â”€â”€ Pause â†’ Escape/Start Button
```

### Player Controllerì— ì ìš©
BeginPlayì—ì„œ:
```cpp
Enhanced Input Subsystem->Add Mapping Context(IMC_JumpMap, Priority: 0)
```
</Steps>

## 4. í”Œë ˆì´ì–´ ìƒí˜¸ì‘ìš© ì‹œìŠ¤í…œ

### ì½”ì¸ ìˆ˜ì§‘ ì²˜ë¦¬

```mermaid
graph TB
    A[Player Overlaps Coin] --> B[Coin OnBeginOverlap]
    B --> C[Get Player State]
    C --> D[Call CollectCoin]
    D --> E[Add Score]
    E --> F[Update UI]
    F --> G[Play Effects]
    G --> H[Hide Coin]
```

### ì²´í¬í¬ì¸íŠ¸ ì‹œìŠ¤í…œ

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
  <div className="border rounded-lg p-4">
    <h4 className="font-bold mb-2">ì²´í¬í¬ì¸íŠ¸ ë„ë‹¬</h4>
```cpp
Function ReachCheckpoint(CheckpointID: Integer)
{
    if (CheckpointID > CheckpointsReached)
    {
        CheckpointsReached = CheckpointID
        SaveCheckpoint()
        ShowNotification("Checkpoint!")
    }
}
```
  </div>
  
  <div className="border rounded-lg p-4">
    <h4 className="font-bold mb-2">ì²´í¬í¬ì¸íŠ¸ ë¦¬ìŠ¤í°</h4>
```cpp
Function RespawnAtCheckpoint()
{
    Location = GetCheckpointLocation(CheckpointsReached)
    ControlledPawn->SetActorLocation(Location)
    Deaths++
    AddScore(-100)  // ì‚¬ë§ í˜ë„í‹°
}
```
  </div>
</div>

## ğŸ“Š ë°ì´í„° ë™ê¸°í™”

### ë©€í‹°í”Œë ˆì´ì–´ ê³ ë ¤ì‚¬í•­

<Callout type="warning" emoji="âš ï¸">
**Replication ì„¤ì • í•„ìˆ˜**:
- Player StateëŠ” ìë™ìœ¼ë¡œ Replicated
- Rep_Notify í•¨ìˆ˜ë¡œ í´ë¼ì´ì–¸íŠ¸ UI ì—…ë°ì´íŠ¸
- Server RPCë¡œ ì¤‘ìš”í•œ ì•¡ì…˜ ê²€ì¦
</Callout>

### Server RPC í•¨ìˆ˜

```cpp
// ì„œë²„ì—ì„œë§Œ ì‹¤í–‰
Function ServerCollectCoin(CoinActor: BP_Coin)
{
    // Run on Server, Reliable
    
    if (IsValid(CoinActor) && !CoinActor->bIsCollected)
    {
        // ì„œë²„ì—ì„œ ê²€ì¦
        CollectCoin(CoinActor->CoinValue)
        
        // ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì— ì•Œë¦¼
        MulticastCoinCollected(CoinActor)
    }
}

// ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‹¤í–‰
Function MulticastCoinCollected(CoinActor: BP_Coin)
{
    // Multicast, Reliable
    
    // ì‹œê° íš¨ê³¼ë§Œ ì²˜ë¦¬
    CoinActor->PlayCollectEffect()
    CoinActor->SetActorHiddenInGame(True)
}
```

## ğŸ“ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

<Callout type="success" emoji="âœ…">
**Player Controller ì²´í¬ë¦¬ìŠ¤íŠ¸**:
- [ ] PC_JumpMap ë¸”ë£¨í”„ë¦°íŠ¸ ìƒì„±
- [ ] Enhanced Input ì„¤ì •
- [ ] Input Actions ë°”ì¸ë”©
- [ ] Pause ì‹œìŠ¤í…œ êµ¬í˜„
- [ ] Result Screen í‘œì‹œ í•¨ìˆ˜
- [ ] ì…ë ¥ í™œì„±í™”/ë¹„í™œì„±í™” í•¨ìˆ˜
</Callout>

<Callout type="success" emoji="âœ…">
**Player State ì²´í¬ë¦¬ìŠ¤íŠ¸**:
- [ ] PS_JumpMap ë¸”ë£¨í”„ë¦°íŠ¸ ìƒì„±
- [ ] ì ìˆ˜ ì‹œìŠ¤í…œ ë³€ìˆ˜ ì„¤ì •
- [ ] AddScore í•¨ìˆ˜ êµ¬í˜„
- [ ] CollectCoin í•¨ìˆ˜ êµ¬í˜„
- [ ] í†µê³„ ì¶”ì  ì‹œìŠ¤í…œ
- [ ] Replication ì„¤ì • (ë©€í‹°í”Œë ˆì´ì–´)
- [ ] OnRep í•¨ìˆ˜ë“¤ êµ¬í˜„
</Callout>

## ë‹¤ìŒ ë‹¨ê³„

Player Controllerì™€ State êµ¬í˜„ì´ ì™„ë£Œë˜ë©´:

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
  <LinkCard
    title="ê²Œì„ ì•¡í„° êµ¬í˜„ (Zones & Coins)"
    description="Start Zone, End Zone, Coin ì•¡í„° êµ¬í˜„"
    href="/unreal/jumpmap/actors"
  />
  <LinkCard
    title="UI/HUD ì‹œìŠ¤í…œ"
    description="ê²Œì„ ì •ë³´ í‘œì‹œì™€ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤"
    href="/unreal/jumpmap/ui-system"
  />
</div>